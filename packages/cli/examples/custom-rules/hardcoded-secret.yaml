# Example custom rule: Detect hardcoded secrets in environment files
id: CUSTOM-SEC-001
version: "1.0.0"
severity: critical
confidence: 0.95
category: secrets
title: "Hardcoded secret in .env file"
description: |
  Environment files contain hardcoded secrets instead of placeholder values.
  Secrets should never be committed to version control. Use placeholder values
  like 'your-secret-here' or reference a secrets management system.

# File filters - only check .env files
files:
  file_type:
    - env
  exclude:
    - "**/.env.example"
    - "**/.env.template"

# Match conditions
match:
  # Look for lines that contain actual values (not placeholders)
  contains: "="
  # Should NOT contain common placeholder indicators
  not_contains: "your-"
  case_sensitive: false

# Context conditions
context:
  # Only flag if file contains these sensitive keywords
  file_contains:
    - "SECRET"
    - "KEY"
    - "PASSWORD"
  # Ignore test/example env files
  file_not_contains:
    - "example"
    - "template"

# Remediation
recommended_fix: |
  Replace hardcoded secrets with placeholder values in committed .env files.
  Use .env.local (gitignored) for actual secrets in development.
  Use secrets management in production (e.g., AWS Secrets Manager, Vault).

links:
  owasp: https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password
  cwe: https://cwe.mitre.org/data/definitions/798.html

# Metadata
metadata:
  author: "VibeCheck Community"
  tags:
    - "secrets"
    - "environment"
  created: "2025-01-07"

# Enable this rule
enabled: true
